\babel@toc {english}{}\relax 
\contentsline {chapter}{\numberline {1}Preface}{3}{chapter.1}%
\contentsline {section}{\numberline {1.1}About}{3}{section.1.1}%
\contentsline {subsection}{\numberline {1.1.1}About this book}{3}{subsection.1.1.1}%
\contentsline {subsection}{\numberline {1.1.2}About the authors}{3}{subsection.1.1.2}%
\contentsline {section}{\numberline {1.2}Feedback and suggestions}{5}{section.1.2}%
\contentsline {chapter}{\numberline {2}Preliminary}{7}{chapter.2}%
\contentsline {section}{\numberline {2.1}Math Preliminary}{7}{section.2.1}%
\contentsline {subsection}{\numberline {2.1.1}Vector}{7}{subsection.2.1.1}%
\contentsline {subsection}{\numberline {2.1.2}Norm}{9}{subsection.2.1.2}%
\contentsline {subsection}{\numberline {2.1.3}Distances}{9}{subsection.2.1.3}%
\contentsline {section}{\numberline {2.2}NLP Preliminary}{11}{section.2.2}%
\contentsline {subsection}{\numberline {2.2.1}Vocabulary}{11}{subsection.2.2.1}%
\contentsline {subsection}{\numberline {2.2.2}Tagging}{12}{subsection.2.2.2}%
\contentsline {subsection}{\numberline {2.2.3}Lemmatization}{13}{subsection.2.2.3}%
\contentsline {subsection}{\numberline {2.2.4}Tokenization}{15}{subsection.2.2.4}%
\contentsline {subsection}{\numberline {2.2.5}BERT Tokenization}{16}{subsection.2.2.5}%
\contentsline {subsection}{\numberline {2.2.6}Modern BERT}{18}{subsection.2.2.6}%
\contentsline {section}{\numberline {2.3}Platform and Packages}{21}{section.2.3}%
\contentsline {subsection}{\numberline {2.3.1}Google Colab}{21}{subsection.2.3.1}%
\contentsline {subsection}{\numberline {2.3.2}HuggingFace}{22}{subsection.2.3.2}%
\contentsline {subsection}{\numberline {2.3.3}Ollama}{23}{subsection.2.3.3}%
\contentsline {subsection}{\numberline {2.3.4}langchain}{24}{subsection.2.3.4}%
\contentsline {chapter}{\numberline {3}Word and Sentence Embedding}{27}{chapter.3}%
\contentsline {section}{\numberline {3.1}Traditional word embeddings}{27}{section.3.1}%
\contentsline {subsection}{\numberline {3.1.1}One Hot Encoder}{28}{subsection.3.1.1}%
\contentsline {subsection}{\numberline {3.1.2}CountVectorizer}{29}{subsection.3.1.2}%
\contentsline {subsection}{\numberline {3.1.3}TF\sphinxhyphen {}IDF}{30}{subsection.3.1.3}%
\contentsline {section}{\numberline {3.2}Static word embeddings}{35}{section.3.2}%
\contentsline {subsection}{\numberline {3.2.1}Word2Vec}{35}{subsection.3.2.1}%
\contentsline {subsection}{\numberline {3.2.2}GloVE}{38}{subsection.3.2.2}%
\contentsline {subsection}{\numberline {3.2.3}Fast Text}{39}{subsection.3.2.3}%
\contentsline {section}{\numberline {3.3}Contextual word embeddings}{40}{section.3.3}%
\contentsline {subsection}{\numberline {3.3.1}BERT}{40}{subsection.3.3.1}%
\contentsline {subsection}{\numberline {3.3.2}gte\sphinxhyphen {}large\sphinxhyphen {}en\sphinxhyphen {}v1.5}{42}{subsection.3.3.2}%
\contentsline {subsection}{\numberline {3.3.3}bge\sphinxhyphen {}base\sphinxhyphen {}en\sphinxhyphen {}v1.5}{43}{subsection.3.3.3}%
\contentsline {chapter}{\numberline {4}Prompt Engineering}{47}{chapter.4}%
\contentsline {section}{\numberline {4.1}Prompt}{47}{section.4.1}%
\contentsline {section}{\numberline {4.2}Prompt Engineering}{47}{section.4.2}%
\contentsline {subsection}{\numberline {4.2.1}Whatâ€™s Prompt Engineering}{47}{subsection.4.2.1}%
\contentsline {subsection}{\numberline {4.2.2}Key Elements of a Prompt}{47}{subsection.4.2.2}%
\contentsline {section}{\numberline {4.3}Advanced Prompt Engineering}{48}{section.4.3}%
\contentsline {subsection}{\numberline {4.3.1}Role Assignment}{48}{subsection.4.3.1}%
\contentsline {subsection}{\numberline {4.3.2}Contextual Setup}{49}{subsection.4.3.2}%
\contentsline {subsection}{\numberline {4.3.3}Explicit Instructions}{50}{subsection.4.3.3}%
\contentsline {subsection}{\numberline {4.3.4}Chain of Thought (CoT) Prompting}{51}{subsection.4.3.4}%
\contentsline {subsection}{\numberline {4.3.5}Few\sphinxhyphen {}Shot Prompting}{52}{subsection.4.3.5}%
\contentsline {subsection}{\numberline {4.3.6}Iterative Prompting}{53}{subsection.4.3.6}%
\contentsline {subsection}{\numberline {4.3.7}Instructional Chaining}{55}{subsection.4.3.7}%
\contentsline {subsection}{\numberline {4.3.8}Use Constraints}{56}{subsection.4.3.8}%
\contentsline {subsection}{\numberline {4.3.9}Creative Prompting}{56}{subsection.4.3.9}%
\contentsline {subsection}{\numberline {4.3.10}Feedback Incorporation}{56}{subsection.4.3.10}%
\contentsline {subsection}{\numberline {4.3.11}Scenario\sphinxhyphen {}Based Prompts}{56}{subsection.4.3.11}%
\contentsline {subsection}{\numberline {4.3.12}Multimodal Prompting}{57}{subsection.4.3.12}%
\contentsline {chapter}{\numberline {5}Retrieval\sphinxhyphen {}Augmented Generation}{59}{chapter.5}%
\contentsline {section}{\numberline {5.1}Overview}{60}{section.5.1}%
\contentsline {section}{\numberline {5.2}Naive RAG}{60}{section.5.2}%
\contentsline {subsection}{\numberline {5.2.1}Indexing}{60}{subsection.5.2.1}%
\contentsline {subsubsection}{Naive Chunking}{61}{subsubsection*.4}%
\contentsline {subsubsection}{Late Chunking}{64}{subsubsection*.5}%
\contentsline {subsubsection}{Types of Indexing}{68}{subsubsection*.6}%
\contentsline {subsubsection}{Vector Database}{68}{subsubsection*.7}%
\contentsline {subsection}{\numberline {5.2.2}Retrieval}{71}{subsection.5.2.2}%
\contentsline {subsubsection}{Common retrieval methods}{71}{subsubsection*.8}%
\contentsline {subsubsection}{Reciprocal Rank Fusion}{73}{subsubsection*.9}%
\contentsline {subsection}{\numberline {5.2.3}Generation}{75}{subsection.5.2.3}%
\contentsline {section}{\numberline {5.3}Self\sphinxhyphen {}RAG}{77}{section.5.3}%
\contentsline {subsection}{\numberline {5.3.1}Load Models}{78}{subsection.5.3.1}%
\contentsline {subsection}{\numberline {5.3.2}Create Index}{80}{subsection.5.3.2}%
\contentsline {subsection}{\numberline {5.3.3}Retrieval}{80}{subsection.5.3.3}%
\contentsline {subsubsection}{Define Retriever}{80}{subsubsection*.10}%
\contentsline {subsubsection}{Retrieval Grader}{81}{subsubsection*.11}%
\contentsline {subsection}{\numberline {5.3.4}Generate}{83}{subsection.5.3.4}%
\contentsline {subsubsection}{Generation}{83}{subsubsection*.12}%
\contentsline {subsubsection}{Answer Grader}{85}{subsubsection*.13}%
\contentsline {subsection}{\numberline {5.3.5}Utilities}{86}{subsection.5.3.5}%
\contentsline {subsubsection}{Hallucination Grader}{86}{subsubsection*.14}%
\contentsline {subsubsection}{Question Re\sphinxhyphen {}writer}{86}{subsubsection*.15}%
\contentsline {subsection}{\numberline {5.3.6}Graph}{87}{subsection.5.3.6}%
\contentsline {subsubsection}{Create the Graph}{87}{subsubsection*.16}%
\contentsline {subsubsection}{Compile Graph}{91}{subsubsection*.17}%
\contentsline {subsubsection}{Graph visualization}{92}{subsubsection*.18}%
\contentsline {subsection}{\numberline {5.3.7}Test}{92}{subsection.5.3.7}%
\contentsline {subsubsection}{Relevant retrieval}{92}{subsubsection*.19}%
\contentsline {subsubsection}{Irrelevant retrieval}{94}{subsubsection*.20}%
\contentsline {section}{\numberline {5.4}Corrective RAG}{97}{section.5.4}%
\contentsline {subsection}{\numberline {5.4.1}Load Models}{97}{subsection.5.4.1}%
\contentsline {subsection}{\numberline {5.4.2}Create Index}{98}{subsection.5.4.2}%
\contentsline {subsection}{\numberline {5.4.3}Retrieval}{99}{subsection.5.4.3}%
\contentsline {subsubsection}{Define Retriever}{99}{subsubsection*.21}%
\contentsline {subsubsection}{Retrieval Grader}{99}{subsubsection*.22}%
\contentsline {subsection}{\numberline {5.4.4}Generate}{100}{subsection.5.4.4}%
\contentsline {subsubsection}{Generation}{100}{subsubsection*.23}%
\contentsline {subsubsection}{Answer Grader}{102}{subsubsection*.24}%
\contentsline {subsection}{\numberline {5.4.5}Utilities}{102}{subsection.5.4.5}%
\contentsline {subsubsection}{Router}{102}{subsubsection*.25}%
\contentsline {subsubsection}{Hallucination Grader}{104}{subsubsection*.26}%
\contentsline {subsubsection}{Question Re\sphinxhyphen {}writer}{104}{subsubsection*.27}%
\contentsline {subsubsection}{Web Search Tool (Google)}{105}{subsubsection*.28}%
\contentsline {subsection}{\numberline {5.4.6}Graph}{105}{subsection.5.4.6}%
\contentsline {subsubsection}{Create the Graph}{105}{subsubsection*.29}%
\contentsline {subsubsection}{Compile Graph}{109}{subsubsection*.30}%
\contentsline {subsubsection}{Graph visualization}{109}{subsubsection*.31}%
\contentsline {subsection}{\numberline {5.4.7}Test}{110}{subsection.5.4.7}%
\contentsline {subsubsection}{Relevant retrieval}{110}{subsubsection*.32}%
\contentsline {subsubsection}{Irrelevant retrieval}{113}{subsubsection*.33}%
\contentsline {section}{\numberline {5.5}Adaptive RAG}{114}{section.5.5}%
\contentsline {subsection}{\numberline {5.5.1}Load Models}{114}{subsection.5.5.1}%
\contentsline {subsection}{\numberline {5.5.2}Create Index}{116}{subsection.5.5.2}%
\contentsline {subsection}{\numberline {5.5.3}Retrieval}{116}{subsection.5.5.3}%
\contentsline {subsubsection}{Define Retriever}{116}{subsubsection*.34}%
\contentsline {subsubsection}{Retrieval Grader}{117}{subsubsection*.35}%
\contentsline {subsection}{\numberline {5.5.4}Generate}{118}{subsection.5.5.4}%
\contentsline {subsubsection}{Generation}{118}{subsubsection*.36}%
\contentsline {subsubsection}{Answer Grader}{120}{subsubsection*.37}%
\contentsline {subsection}{\numberline {5.5.5}Utilities}{120}{subsection.5.5.5}%
\contentsline {subsubsection}{Router}{120}{subsubsection*.38}%
\contentsline {subsubsection}{Hallucination Grader}{123}{subsubsection*.39}%
\contentsline {subsubsection}{Question Re\sphinxhyphen {}writer}{124}{subsubsection*.40}%
\contentsline {subsubsection}{Google Web Search}{124}{subsubsection*.41}%
\contentsline {subsection}{\numberline {5.5.6}Graph}{125}{subsection.5.5.6}%
\contentsline {subsubsection}{Create the Graph}{125}{subsubsection*.42}%
\contentsline {subsubsection}{Compile Graph}{130}{subsubsection*.43}%
\contentsline {subsubsection}{Graph visualization}{131}{subsubsection*.44}%
\contentsline {subsection}{\numberline {5.5.7}Test}{131}{subsection.5.5.7}%
\contentsline {subsubsection}{Relevant retrieval}{131}{subsubsection*.45}%
\contentsline {subsubsection}{Irrelevant retrieval}{133}{subsubsection*.46}%
\contentsline {section}{\numberline {5.6}Agentic RAG}{136}{section.5.6}%
\contentsline {subsection}{\numberline {5.6.1}Load Models}{136}{subsection.5.6.1}%
\contentsline {subsection}{\numberline {5.6.2}Create Index}{138}{subsection.5.6.2}%
\contentsline {subsection}{\numberline {5.6.3}Retrieval Tool}{139}{subsection.5.6.3}%
\contentsline {subsubsection}{Define Tool}{139}{subsubsection*.47}%
\contentsline {subsubsection}{Retrieval Grader}{140}{subsubsection*.48}%
\contentsline {subsection}{\numberline {5.6.4}Generate}{141}{subsection.5.6.4}%
\contentsline {subsection}{\numberline {5.6.5}Agent State}{142}{subsection.5.6.5}%
\contentsline {subsection}{\numberline {5.6.6}Graph}{142}{subsection.5.6.6}%
\contentsline {subsubsection}{Create the Graph}{142}{subsubsection*.49}%
\contentsline {subsubsection}{Compile Graph}{146}{subsubsection*.50}%
\contentsline {subsubsection}{Graph visualization}{147}{subsubsection*.51}%
\contentsline {subsection}{\numberline {5.6.7}Test}{147}{subsection.5.6.7}%
\contentsline {section}{\numberline {5.7}Advanced Topics}{150}{section.5.7}%
\contentsline {subsection}{\numberline {5.7.1}Multi\sphinxhyphen {}agent Systems}{150}{subsection.5.7.1}%
\contentsline {subsubsection}{Multi\sphinxhyphen {}agent architectures}{150}{subsubsection*.52}%
\contentsline {subsubsection}{Command: Edgeless graphs}{150}{subsubsection*.53}%
\contentsline {chapter}{\numberline {6}Fine Tuning}{155}{chapter.6}%
\contentsline {section}{\numberline {6.1}Cutting\sphinxhyphen {}Edge Strategies for LLM Fine\sphinxhyphen {}Tuning}{156}{section.6.1}%
\contentsline {subsection}{\numberline {6.1.1}LoRA (Low\sphinxhyphen {}Rank Adaptation)}{156}{subsection.6.1.1}%
\contentsline {subsection}{\numberline {6.1.2}QLoRA (Quantized Low\sphinxhyphen {}Rank Adaptation)}{156}{subsection.6.1.2}%
\contentsline {subsection}{\numberline {6.1.3}PEFT (Parameter\sphinxhyphen {}Efficient Fine\sphinxhyphen {}Tuning)}{157}{subsection.6.1.3}%
\contentsline {subsection}{\numberline {6.1.4}SFT (Supervised Fine\sphinxhyphen {}Tuning)}{157}{subsection.6.1.4}%
\contentsline {subsection}{\numberline {6.1.5}RLHF (Reinforcement Learning from Human Feedback)}{158}{subsection.6.1.5}%
\contentsline {subsubsection}{PPO}{159}{subsubsection*.54}%
\contentsline {subsubsection}{DPO}{164}{subsubsection*.55}%
\contentsline {subsubsection}{Main Difficulties in RLHF}{167}{subsubsection*.56}%
\contentsline {subsection}{\numberline {6.1.6}Summary Table}{169}{subsection.6.1.6}%
\contentsline {section}{\numberline {6.2}Key Early Fine\sphinxhyphen {}Tuning Methods}{169}{section.6.2}%
\contentsline {subsection}{\numberline {6.2.1}Full Fine\sphinxhyphen {}Tuning}{169}{subsection.6.2.1}%
\contentsline {subsection}{\numberline {6.2.2}Feature\sphinxhyphen {}Based Approach}{170}{subsection.6.2.2}%
\contentsline {subsection}{\numberline {6.2.3}Layer\sphinxhyphen {}Specific Fine\sphinxhyphen {}Tuning}{170}{subsection.6.2.3}%
\contentsline {subsection}{\numberline {6.2.4}Task\sphinxhyphen {}Adaptive Pre\sphinxhyphen {}training}{170}{subsection.6.2.4}%
\contentsline {section}{\numberline {6.3}Embedding Model Fine\sphinxhyphen {}Tuning}{170}{section.6.3}%
\contentsline {subsection}{\numberline {6.3.1}Prepare Dataset}{171}{subsection.6.3.1}%
\contentsline {subsection}{\numberline {6.3.2}Import and Evaluate Pretrained Baseline Model}{172}{subsection.6.3.2}%
\contentsline {subsection}{\numberline {6.3.3}Loss Function with Matryoshka Representation}{174}{subsection.6.3.3}%
\contentsline {subsection}{\numberline {6.3.4}Fine\sphinxhyphen {}tune Embedding Model}{176}{subsection.6.3.4}%
\contentsline {subsection}{\numberline {6.3.5}Evaluate Fine\sphinxhyphen {}tuned Model}{177}{subsection.6.3.5}%
\contentsline {subsection}{\numberline {6.3.6}Results Comparison}{177}{subsection.6.3.6}%
\contentsline {section}{\numberline {6.4}LLM Fine\sphinxhyphen {}Tuning}{178}{section.6.4}%
\contentsline {subsection}{\numberline {6.4.1}Load Dataset and Pretrained Model}{178}{subsection.6.4.1}%
\contentsline {subsection}{\numberline {6.4.2}Fine\sphinxhyphen {}tuning Configuration}{179}{subsection.6.4.2}%
\contentsline {subsection}{\numberline {6.4.3}Fine\sphinxhyphen {}tune model}{180}{subsection.6.4.3}%
\contentsline {chapter}{\numberline {7}Pre\sphinxhyphen {}training}{183}{chapter.7}%
\contentsline {section}{\numberline {7.1}Transformer Architecture}{184}{section.7.1}%
\contentsline {subsection}{\numberline {7.1.1}Attention Is All You Need}{184}{subsection.7.1.1}%
\contentsline {subsection}{\numberline {7.1.2}Encoder\sphinxhyphen {}Decoder}{185}{subsection.7.1.2}%
\contentsline {subsection}{\numberline {7.1.3}Positional Encoding}{186}{subsection.7.1.3}%
\contentsline {subsubsection}{Sinusoidal Positional Encodings}{186}{subsubsection*.57}%
\contentsline {subsubsection}{Rotary Positional Embeddings (RoPE)}{187}{subsubsection*.58}%
\contentsline {subsubsection}{\sphinxstylestrong {Learnable Positional Encodings}}{188}{subsubsection*.59}%
\contentsline {subsubsection}{Summary}{188}{subsubsection*.60}%
\contentsline {subsection}{\numberline {7.1.4}Embedding Matrix}{188}{subsection.7.1.4}%
\contentsline {subsection}{\numberline {7.1.5}Attention Mechanism}{189}{subsection.7.1.5}%
\contentsline {subsubsection}{Self\sphinxhyphen {}Attention}{189}{subsubsection*.61}%
\contentsline {subsubsection}{Cross Attention}{195}{subsubsection*.62}%
\contentsline {subsection}{\numberline {7.1.6}Layer Normalization}{196}{subsection.7.1.6}%
\contentsline {subsection}{\numberline {7.1.7}Residual Connections}{197}{subsection.7.1.7}%
\contentsline {subsection}{\numberline {7.1.8}Feed\sphinxhyphen {}Forward Networks}{197}{subsection.7.1.8}%
\contentsline {subsection}{\numberline {7.1.9}Label Smoothing}{198}{subsection.7.1.9}%
\contentsline {subsection}{\numberline {7.1.10}Softmax and Temperature}{199}{subsection.7.1.10}%
\contentsline {subsection}{\numberline {7.1.11}Unembedding Matrix}{199}{subsection.7.1.11}%
\contentsline {subsection}{\numberline {7.1.12}Decoding}{200}{subsection.7.1.12}%
\contentsline {subsubsection}{Greedy Decoding}{200}{subsubsection*.63}%
\contentsline {subsubsection}{Beam Search}{200}{subsubsection*.64}%
\contentsline {subsubsection}{Top\sphinxhyphen {}k Sampling}{201}{subsubsection*.65}%
\contentsline {subsubsection}{Top\sphinxhyphen {}p (Nucleus) Sampling}{201}{subsubsection*.66}%
\contentsline {subsubsection}{Temperature Scaling}{202}{subsubsection*.67}%
\contentsline {subsubsection}{Summary}{203}{subsubsection*.68}%
\contentsline {section}{\numberline {7.2}Modern Transformer Techniques}{203}{section.7.2}%
\contentsline {subsection}{\numberline {7.2.1}KV Cache}{203}{subsection.7.2.1}%
\contentsline {subsection}{\numberline {7.2.2}Multi\sphinxhyphen {}Query Attention}{205}{subsection.7.2.2}%
\contentsline {subsection}{\numberline {7.2.3}Grouped\sphinxhyphen {}Query Attention}{206}{subsection.7.2.3}%
\contentsline {subsection}{\numberline {7.2.4}Flash Attention}{207}{subsection.7.2.4}%
\contentsline {chapter}{\numberline {8}LLM Evaluation Metrics}{211}{chapter.8}%
\contentsline {section}{\numberline {8.1}Statistical Scorers (Traditional Metrics)}{212}{section.8.1}%
\contentsline {section}{\numberline {8.2}Model\sphinxhyphen {}Based Scorers (Learned Metrics)}{212}{section.8.2}%
\contentsline {section}{\numberline {8.3}Human\sphinxhyphen {}Centric Evaluations (Augmenting Metrics)}{213}{section.8.3}%
\contentsline {section}{\numberline {8.4}GEval with DeepEval}{213}{section.8.4}%
\contentsline {subsection}{\numberline {8.4.1}G\sphinxhyphen {}Eval Algorithm}{213}{subsection.8.4.1}%
\contentsline {subsection}{\numberline {8.4.2}G\sphinxhyphen {}Eval with DeepEval}{213}{subsection.8.4.2}%
\contentsline {chapter}{\numberline {9}LLM Guardrails}{225}{chapter.9}%
\contentsline {section}{\numberline {9.1}LLM Risks}{225}{section.9.1}%
\contentsline {section}{\numberline {9.2}Overview of Jailbreak Techniques}{226}{section.9.2}%
\contentsline {section}{\numberline {9.3}Introduction to Guardrails}{229}{section.9.3}%
\contentsline {section}{\numberline {9.4}Overview of Guardrails Tools}{232}{section.9.4}%
\contentsline {section}{\numberline {9.5}NeMo Guardrails}{237}{section.9.5}%
\contentsline {subsection}{\numberline {9.5.1}Yaml Config}{237}{subsection.9.5.1}%
\contentsline {subsection}{\numberline {9.5.2}Rails}{244}{subsection.9.5.2}%
\contentsline {subsection}{\numberline {9.5.3}Test}{244}{subsection.9.5.3}%
\contentsline {subsubsection}{Safe Usecase}{244}{subsubsection*.69}%
\contentsline {subsubsection}{Unsafe Usecases}{246}{subsubsection*.70}%
\contentsline {section}{\numberline {9.6}Llama Guard3}{249}{section.9.6}%
\contentsline {subsection}{\numberline {9.6.1}Load Models}{249}{subsection.9.6.1}%
\contentsline {subsection}{\numberline {9.6.2}Define Safety Check}{249}{subsection.9.6.2}%
\contentsline {subsection}{\numberline {9.6.3}Tests}{250}{subsection.9.6.3}%
\contentsline {subsubsection}{Safe Usecase}{250}{subsubsection*.71}%
\contentsline {subsubsection}{Unsafe Usecase}{251}{subsubsection*.72}%
\contentsline {chapter}{\numberline {10}Main Reference}{253}{chapter.10}%
\contentsline {chapter}{Bibliography}{255}{chapter*.73}%
