\babel@toc {english}{}\relax 
\contentsline {chapter}{\numberline {1}Preface}{3}{chapter.1}%
\contentsline {section}{\numberline {1.1}About}{3}{section.1.1}%
\contentsline {subsection}{\numberline {1.1.1}About this book}{3}{subsection.1.1.1}%
\contentsline {subsection}{\numberline {1.1.2}About the authors}{3}{subsection.1.1.2}%
\contentsline {section}{\numberline {1.2}Feedback and suggestions}{5}{section.1.2}%
\contentsline {chapter}{\numberline {2}Preliminary}{7}{chapter.2}%
\contentsline {section}{\numberline {2.1}Math Preliminary}{7}{section.2.1}%
\contentsline {subsection}{\numberline {2.1.1}Vector}{7}{subsection.2.1.1}%
\contentsline {subsection}{\numberline {2.1.2}Norm}{9}{subsection.2.1.2}%
\contentsline {subsection}{\numberline {2.1.3}Distances}{9}{subsection.2.1.3}%
\contentsline {section}{\numberline {2.2}NLP Preliminary}{11}{section.2.2}%
\contentsline {subsection}{\numberline {2.2.1}Vocabulary}{11}{subsection.2.2.1}%
\contentsline {subsection}{\numberline {2.2.2}Tagging}{12}{subsection.2.2.2}%
\contentsline {subsection}{\numberline {2.2.3}Lemmatization}{13}{subsection.2.2.3}%
\contentsline {subsection}{\numberline {2.2.4}Tokenization}{15}{subsection.2.2.4}%
\contentsline {subsection}{\numberline {2.2.5}BERT Tokenization}{16}{subsection.2.2.5}%
\contentsline {subsection}{\numberline {2.2.6}Modern BERT}{18}{subsection.2.2.6}%
\contentsline {section}{\numberline {2.3}Platform and Packages}{21}{section.2.3}%
\contentsline {subsection}{\numberline {2.3.1}Google Colab}{21}{subsection.2.3.1}%
\contentsline {subsection}{\numberline {2.3.2}HuggingFace}{22}{subsection.2.3.2}%
\contentsline {subsection}{\numberline {2.3.3}Ollama}{23}{subsection.2.3.3}%
\contentsline {subsection}{\numberline {2.3.4}langchain}{24}{subsection.2.3.4}%
\contentsline {chapter}{\numberline {3}Word and Sentence Embedding}{27}{chapter.3}%
\contentsline {section}{\numberline {3.1}Traditional word embeddings}{27}{section.3.1}%
\contentsline {subsection}{\numberline {3.1.1}One Hot Encoder}{28}{subsection.3.1.1}%
\contentsline {subsection}{\numberline {3.1.2}CountVectorizer}{29}{subsection.3.1.2}%
\contentsline {subsection}{\numberline {3.1.3}TF\sphinxhyphen {}IDF}{30}{subsection.3.1.3}%
\contentsline {section}{\numberline {3.2}Static word embeddings}{34}{section.3.2}%
\contentsline {subsection}{\numberline {3.2.1}Word2Vec}{35}{subsection.3.2.1}%
\contentsline {subsection}{\numberline {3.2.2}GloVE}{37}{subsection.3.2.2}%
\contentsline {subsection}{\numberline {3.2.3}Fast Text}{38}{subsection.3.2.3}%
\contentsline {section}{\numberline {3.3}Contextual word embeddings}{39}{section.3.3}%
\contentsline {subsection}{\numberline {3.3.1}BERT}{39}{subsection.3.3.1}%
\contentsline {subsection}{\numberline {3.3.2}gte\sphinxhyphen {}large\sphinxhyphen {}en\sphinxhyphen {}v1.5}{40}{subsection.3.3.2}%
\contentsline {subsection}{\numberline {3.3.3}bge\sphinxhyphen {}base\sphinxhyphen {}en\sphinxhyphen {}v1.5}{41}{subsection.3.3.3}%
\contentsline {chapter}{\numberline {4}Prompt Engineering}{45}{chapter.4}%
\contentsline {section}{\numberline {4.1}Prompt}{45}{section.4.1}%
\contentsline {section}{\numberline {4.2}Prompt Engineering}{45}{section.4.2}%
\contentsline {subsection}{\numberline {4.2.1}Whatâ€™s Prompt Engineering}{45}{subsection.4.2.1}%
\contentsline {subsection}{\numberline {4.2.2}Key Elements of a Prompt}{45}{subsection.4.2.2}%
\contentsline {section}{\numberline {4.3}Advanced Prompt Engineering}{46}{section.4.3}%
\contentsline {subsection}{\numberline {4.3.1}Role Assignment}{46}{subsection.4.3.1}%
\contentsline {subsection}{\numberline {4.3.2}Contextual Setup}{47}{subsection.4.3.2}%
\contentsline {subsection}{\numberline {4.3.3}Explicit Instructions}{48}{subsection.4.3.3}%
\contentsline {subsection}{\numberline {4.3.4}Chain of Thought (CoT) Prompting}{49}{subsection.4.3.4}%
\contentsline {subsection}{\numberline {4.3.5}Few\sphinxhyphen {}Shot Prompting}{50}{subsection.4.3.5}%
\contentsline {subsection}{\numberline {4.3.6}Iterative Prompting}{51}{subsection.4.3.6}%
\contentsline {subsection}{\numberline {4.3.7}Instructional Chaining}{53}{subsection.4.3.7}%
\contentsline {subsection}{\numberline {4.3.8}Use Constraints}{54}{subsection.4.3.8}%
\contentsline {subsection}{\numberline {4.3.9}Creative Prompting}{54}{subsection.4.3.9}%
\contentsline {subsection}{\numberline {4.3.10}Feedback Incorporation}{54}{subsection.4.3.10}%
\contentsline {subsection}{\numberline {4.3.11}Scenario\sphinxhyphen {}Based Prompts}{54}{subsection.4.3.11}%
\contentsline {subsection}{\numberline {4.3.12}Multimodal Prompting}{55}{subsection.4.3.12}%
\contentsline {chapter}{\numberline {5}Retrieval\sphinxhyphen {}Augmented Generation}{57}{chapter.5}%
\contentsline {section}{\numberline {5.1}Overview}{58}{section.5.1}%
\contentsline {section}{\numberline {5.2}Naive RAG}{58}{section.5.2}%
\contentsline {subsection}{\numberline {5.2.1}Indexing}{58}{subsection.5.2.1}%
\contentsline {subsubsection}{Naive Chunking}{59}{subsubsection*.4}%
\contentsline {subsubsection}{Late Chunking}{62}{subsubsection*.5}%
\contentsline {subsubsection}{Types of Indexing}{66}{subsubsection*.6}%
\contentsline {subsubsection}{Vector Database}{66}{subsubsection*.7}%
\contentsline {subsection}{\numberline {5.2.2}Retrieval}{69}{subsection.5.2.2}%
\contentsline {subsubsection}{Common retrieval methods}{69}{subsubsection*.8}%
\contentsline {subsubsection}{Reciprocal Rank Fusion}{71}{subsubsection*.9}%
\contentsline {subsection}{\numberline {5.2.3}Generation}{73}{subsection.5.2.3}%
\contentsline {section}{\numberline {5.3}Self\sphinxhyphen {}RAG}{75}{section.5.3}%
\contentsline {subsection}{\numberline {5.3.1}Load Models}{76}{subsection.5.3.1}%
\contentsline {subsection}{\numberline {5.3.2}Create Index}{78}{subsection.5.3.2}%
\contentsline {subsection}{\numberline {5.3.3}Retrieval}{78}{subsection.5.3.3}%
\contentsline {subsubsection}{Define Retriever}{78}{subsubsection*.10}%
\contentsline {subsubsection}{Retrieval Grader}{79}{subsubsection*.11}%
\contentsline {subsection}{\numberline {5.3.4}Generate}{81}{subsection.5.3.4}%
\contentsline {subsubsection}{Generation}{81}{subsubsection*.12}%
\contentsline {subsubsection}{Answer Grader}{83}{subsubsection*.13}%
\contentsline {subsection}{\numberline {5.3.5}Utilities}{84}{subsection.5.3.5}%
\contentsline {subsubsection}{Hallucination Grader}{84}{subsubsection*.14}%
\contentsline {subsubsection}{Question Re\sphinxhyphen {}writer}{84}{subsubsection*.15}%
\contentsline {subsection}{\numberline {5.3.6}Graph}{85}{subsection.5.3.6}%
\contentsline {subsubsection}{Create the Graph}{85}{subsubsection*.16}%
\contentsline {subsubsection}{Compile Graph}{89}{subsubsection*.17}%
\contentsline {subsubsection}{Graph visualization}{90}{subsubsection*.18}%
\contentsline {subsection}{\numberline {5.3.7}Test}{90}{subsection.5.3.7}%
\contentsline {subsubsection}{Relevant retrieval}{90}{subsubsection*.19}%
\contentsline {subsubsection}{Irrelevant retrieval}{92}{subsubsection*.20}%
\contentsline {section}{\numberline {5.4}Corrective RAG}{95}{section.5.4}%
\contentsline {subsection}{\numberline {5.4.1}Load Models}{95}{subsection.5.4.1}%
\contentsline {subsection}{\numberline {5.4.2}Create Index}{96}{subsection.5.4.2}%
\contentsline {subsection}{\numberline {5.4.3}Retrieval}{97}{subsection.5.4.3}%
\contentsline {subsubsection}{Define Retriever}{97}{subsubsection*.21}%
\contentsline {subsubsection}{Retrieval Grader}{97}{subsubsection*.22}%
\contentsline {subsection}{\numberline {5.4.4}Generate}{98}{subsection.5.4.4}%
\contentsline {subsubsection}{Generation}{98}{subsubsection*.23}%
\contentsline {subsubsection}{Answer Grader}{100}{subsubsection*.24}%
\contentsline {subsection}{\numberline {5.4.5}Utilities}{100}{subsection.5.4.5}%
\contentsline {subsubsection}{Router}{100}{subsubsection*.25}%
\contentsline {subsubsection}{Hallucination Grader}{102}{subsubsection*.26}%
\contentsline {subsubsection}{Question Re\sphinxhyphen {}writer}{102}{subsubsection*.27}%
\contentsline {subsubsection}{Web Search Tool (Google)}{103}{subsubsection*.28}%
\contentsline {subsection}{\numberline {5.4.6}Graph}{103}{subsection.5.4.6}%
\contentsline {subsubsection}{Create the Graph}{103}{subsubsection*.29}%
\contentsline {subsubsection}{Compile Graph}{107}{subsubsection*.30}%
\contentsline {subsubsection}{Graph visualization}{107}{subsubsection*.31}%
\contentsline {subsection}{\numberline {5.4.7}Test}{108}{subsection.5.4.7}%
\contentsline {subsubsection}{Relevant retrieval}{108}{subsubsection*.32}%
\contentsline {subsubsection}{Irrelevant retrieval}{111}{subsubsection*.33}%
\contentsline {section}{\numberline {5.5}Adaptive RAG}{112}{section.5.5}%
\contentsline {subsection}{\numberline {5.5.1}Load Models}{112}{subsection.5.5.1}%
\contentsline {subsection}{\numberline {5.5.2}Create Index}{114}{subsection.5.5.2}%
\contentsline {subsection}{\numberline {5.5.3}Retrieval}{114}{subsection.5.5.3}%
\contentsline {subsubsection}{Define Retriever}{114}{subsubsection*.34}%
\contentsline {subsubsection}{Retrieval Grader}{115}{subsubsection*.35}%
\contentsline {subsection}{\numberline {5.5.4}Generate}{116}{subsection.5.5.4}%
\contentsline {subsubsection}{Generation}{116}{subsubsection*.36}%
\contentsline {subsubsection}{Answer Grader}{118}{subsubsection*.37}%
\contentsline {subsection}{\numberline {5.5.5}Utilities}{118}{subsection.5.5.5}%
\contentsline {subsubsection}{Router}{118}{subsubsection*.38}%
\contentsline {subsubsection}{Hallucination Grader}{121}{subsubsection*.39}%
\contentsline {subsubsection}{Question Re\sphinxhyphen {}writer}{122}{subsubsection*.40}%
\contentsline {subsubsection}{Google Web Search}{122}{subsubsection*.41}%
\contentsline {subsection}{\numberline {5.5.6}Graph}{123}{subsection.5.5.6}%
\contentsline {subsubsection}{Create the Graph}{123}{subsubsection*.42}%
\contentsline {subsubsection}{Compile Graph}{128}{subsubsection*.43}%
\contentsline {subsubsection}{Graph visualization}{129}{subsubsection*.44}%
\contentsline {subsection}{\numberline {5.5.7}Test}{129}{subsection.5.5.7}%
\contentsline {subsubsection}{Relevant retrieval}{129}{subsubsection*.45}%
\contentsline {subsubsection}{Irrelevant retrieval}{131}{subsubsection*.46}%
\contentsline {section}{\numberline {5.6}Agentic RAG}{134}{section.5.6}%
\contentsline {subsection}{\numberline {5.6.1}Load Models}{134}{subsection.5.6.1}%
\contentsline {subsection}{\numberline {5.6.2}Create Index}{136}{subsection.5.6.2}%
\contentsline {subsection}{\numberline {5.6.3}Retrieval Tool}{137}{subsection.5.6.3}%
\contentsline {subsubsection}{Define Tool}{137}{subsubsection*.47}%
\contentsline {subsubsection}{Retrieval Grader}{138}{subsubsection*.48}%
\contentsline {subsection}{\numberline {5.6.4}Generate}{139}{subsection.5.6.4}%
\contentsline {subsection}{\numberline {5.6.5}Agent State}{140}{subsection.5.6.5}%
\contentsline {subsection}{\numberline {5.6.6}Graph}{140}{subsection.5.6.6}%
\contentsline {subsubsection}{Create the Graph}{140}{subsubsection*.49}%
\contentsline {subsubsection}{Compile Graph}{144}{subsubsection*.50}%
\contentsline {subsubsection}{Graph visualization}{145}{subsubsection*.51}%
\contentsline {subsection}{\numberline {5.6.7}Test}{145}{subsection.5.6.7}%
\contentsline {section}{\numberline {5.7}Advanced Topics}{148}{section.5.7}%
\contentsline {subsection}{\numberline {5.7.1}Multi\sphinxhyphen {}agent Systems}{148}{subsection.5.7.1}%
\contentsline {subsubsection}{Multi\sphinxhyphen {}agent architectures}{148}{subsubsection*.52}%
\contentsline {subsubsection}{Command: Edgeless graphs}{148}{subsubsection*.53}%
\contentsline {chapter}{\numberline {6}Fine Tuning}{153}{chapter.6}%
\contentsline {section}{\numberline {6.1}Cutting\sphinxhyphen {}Edge Strategies for LLM Fine\sphinxhyphen {}Tuning}{154}{section.6.1}%
\contentsline {subsection}{\numberline {6.1.1}LoRA (Low\sphinxhyphen {}Rank Adaptation)}{154}{subsection.6.1.1}%
\contentsline {subsection}{\numberline {6.1.2}QLoRA (Quantized Low\sphinxhyphen {}Rank Adaptation)}{154}{subsection.6.1.2}%
\contentsline {subsection}{\numberline {6.1.3}PEFT (Parameter\sphinxhyphen {}Efficient Fine\sphinxhyphen {}Tuning)}{155}{subsection.6.1.3}%
\contentsline {subsection}{\numberline {6.1.4}SFT (Supervised Fine\sphinxhyphen {}Tuning)}{155}{subsection.6.1.4}%
\contentsline {subsection}{\numberline {6.1.5}RLHF (Reinforcement Learning from Human Feedback)}{156}{subsection.6.1.5}%
\contentsline {subsection}{\numberline {6.1.6}Summary Table}{157}{subsection.6.1.6}%
\contentsline {section}{\numberline {6.2}Key Early Fine\sphinxhyphen {}Tuning Methods}{157}{section.6.2}%
\contentsline {subsection}{\numberline {6.2.1}Full Fine\sphinxhyphen {}Tuning}{157}{subsection.6.2.1}%
\contentsline {subsection}{\numberline {6.2.2}Feature\sphinxhyphen {}Based Approach}{158}{subsection.6.2.2}%
\contentsline {subsection}{\numberline {6.2.3}Layer\sphinxhyphen {}Specific Fine\sphinxhyphen {}Tuning}{158}{subsection.6.2.3}%
\contentsline {subsection}{\numberline {6.2.4}Task\sphinxhyphen {}Adaptive Pre\sphinxhyphen {}training}{158}{subsection.6.2.4}%
\contentsline {section}{\numberline {6.3}Embedding Model Fine\sphinxhyphen {}Tuning}{158}{section.6.3}%
\contentsline {subsection}{\numberline {6.3.1}Prepare Dataset}{159}{subsection.6.3.1}%
\contentsline {subsection}{\numberline {6.3.2}Import and Evaluate Pretrained Baseline Model}{160}{subsection.6.3.2}%
\contentsline {subsection}{\numberline {6.3.3}Loss Function with Matryoshka Representation}{162}{subsection.6.3.3}%
\contentsline {subsection}{\numberline {6.3.4}Fine\sphinxhyphen {}tune Embedding Model}{164}{subsection.6.3.4}%
\contentsline {subsection}{\numberline {6.3.5}Evaluate Fine\sphinxhyphen {}tuned Model}{165}{subsection.6.3.5}%
\contentsline {subsection}{\numberline {6.3.6}Results Comparison}{165}{subsection.6.3.6}%
\contentsline {section}{\numberline {6.4}LLM Fine\sphinxhyphen {}Tuning}{166}{section.6.4}%
\contentsline {subsection}{\numberline {6.4.1}Load Dataset and Pretrained Model}{166}{subsection.6.4.1}%
\contentsline {subsection}{\numberline {6.4.2}Fine\sphinxhyphen {}tuning Configuration}{167}{subsection.6.4.2}%
\contentsline {subsection}{\numberline {6.4.3}Fine\sphinxhyphen {}tune model}{168}{subsection.6.4.3}%
\contentsline {chapter}{\numberline {7}Pre\sphinxhyphen {}training}{171}{chapter.7}%
\contentsline {section}{\numberline {7.1}Transformer Architecture}{172}{section.7.1}%
\contentsline {subsection}{\numberline {7.1.1}Attention Is All You Need}{172}{subsection.7.1.1}%
\contentsline {subsection}{\numberline {7.1.2}Encoder\sphinxhyphen {}Decoder}{173}{subsection.7.1.2}%
\contentsline {subsection}{\numberline {7.1.3}Positional Encoding}{174}{subsection.7.1.3}%
\contentsline {subsubsection}{Sinusoidal Positional Encodings}{174}{subsubsection*.54}%
\contentsline {subsubsection}{Rotary Positional Embeddings (RoPE)}{175}{subsubsection*.55}%
\contentsline {subsubsection}{\sphinxstylestrong {Learnable Positional Encodings}}{176}{subsubsection*.56}%
\contentsline {subsubsection}{Summary}{176}{subsubsection*.57}%
\contentsline {subsection}{\numberline {7.1.4}Embedding Matrix}{176}{subsection.7.1.4}%
\contentsline {subsection}{\numberline {7.1.5}Attention Mechanism}{177}{subsection.7.1.5}%
\contentsline {subsubsection}{Self\sphinxhyphen {}Attention}{177}{subsubsection*.58}%
\contentsline {subsubsection}{Cross Attention}{183}{subsubsection*.59}%
\contentsline {subsection}{\numberline {7.1.6}Layer Normalization}{184}{subsection.7.1.6}%
\contentsline {subsection}{\numberline {7.1.7}Residual Connections}{185}{subsection.7.1.7}%
\contentsline {subsection}{\numberline {7.1.8}Feed\sphinxhyphen {}Forward Networks}{185}{subsection.7.1.8}%
\contentsline {subsection}{\numberline {7.1.9}Label Smoothing}{186}{subsection.7.1.9}%
\contentsline {subsection}{\numberline {7.1.10}Softmax and Temperature}{187}{subsection.7.1.10}%
\contentsline {subsection}{\numberline {7.1.11}Unembedding Matrix}{187}{subsection.7.1.11}%
\contentsline {subsection}{\numberline {7.1.12}Decoding}{188}{subsection.7.1.12}%
\contentsline {subsubsection}{Greedy Decoding}{188}{subsubsection*.60}%
\contentsline {subsubsection}{Beam Search}{188}{subsubsection*.61}%
\contentsline {subsubsection}{Top\sphinxhyphen {}k Sampling}{189}{subsubsection*.62}%
\contentsline {subsubsection}{Top\sphinxhyphen {}p (Nucleus) Sampling}{189}{subsubsection*.63}%
\contentsline {subsubsection}{Temperature Scaling}{190}{subsubsection*.64}%
\contentsline {subsubsection}{Summary}{191}{subsubsection*.65}%
\contentsline {section}{\numberline {7.2}Modern Transformer Techniques}{191}{section.7.2}%
\contentsline {subsection}{\numberline {7.2.1}KV Cache}{191}{subsection.7.2.1}%
\contentsline {subsection}{\numberline {7.2.2}Multi\sphinxhyphen {}Query Attention}{193}{subsection.7.2.2}%
\contentsline {subsection}{\numberline {7.2.3}Grouped\sphinxhyphen {}Query Attention}{194}{subsection.7.2.3}%
\contentsline {subsection}{\numberline {7.2.4}Flash Attention}{195}{subsection.7.2.4}%
\contentsline {chapter}{\numberline {8}LLM Evaluation Metrics}{199}{chapter.8}%
\contentsline {section}{\numberline {8.1}Statistical Scorers (Traditional Metrics)}{200}{section.8.1}%
\contentsline {section}{\numberline {8.2}Model\sphinxhyphen {}Based Scorers (Learned Metrics)}{200}{section.8.2}%
\contentsline {section}{\numberline {8.3}Human\sphinxhyphen {}Centric Evaluations (Augmenting Metrics)}{201}{section.8.3}%
\contentsline {section}{\numberline {8.4}GEval with DeepEval}{201}{section.8.4}%
\contentsline {subsection}{\numberline {8.4.1}G\sphinxhyphen {}Eval Algorithm}{201}{subsection.8.4.1}%
\contentsline {subsection}{\numberline {8.4.2}G\sphinxhyphen {}Eval with DeepEval}{201}{subsection.8.4.2}%
\contentsline {chapter}{\numberline {9}LLM Guardrails}{213}{chapter.9}%
\contentsline {section}{\numberline {9.1}LLM Risks}{213}{section.9.1}%
\contentsline {section}{\numberline {9.2}Overview of Jailbreak Techniques}{214}{section.9.2}%
\contentsline {section}{\numberline {9.3}Introduction to Guardrails}{217}{section.9.3}%
\contentsline {section}{\numberline {9.4}Overview of Guardrails Tools}{222}{section.9.4}%
\contentsline {chapter}{\numberline {10}Main Reference}{227}{chapter.10}%
\contentsline {chapter}{Bibliography}{229}{chapter*.66}%
